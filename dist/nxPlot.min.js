/*! Wed Jul 16 2025 22:17:58 GMT+0100 (British Summer Time) */
!function(){"use strict";const e="[nxPlot]",t=t=>console.log(`${e} ${t}`),s=t=>console.error(`${e} Error: ${t}`),a=()=>document.documentElement.classList.contains("theme-dark"),i={dark:{blue:"#63d7d6",highlight:"#fff",green:"#65d235",red:"#ea2b34",yellow:"#E8B131",greenSeries:["#65d235","#A5D712","#02B546"],redSeries:["#ea2b34","#F64A2D","#C92845"],yellowSeries:["#FAD94B","#E8B131","#F1F555"],standard:["#1451b3","#175ece","#1a69e5"],varied:["#0a83ea","#18949f","#781cea","#3f0aea"],dual:["#1472DE","#2E4259"]},light:{blue:"#00f",highlight:"#000",green:"#418c20",red:"#da3e43",yellow:"#E69812",greenSeries:["#418c20","#598617","#139149"],redSeries:["#da3e43","#E64C02","#E64562"],yellowSeries:["#FCCE14","#E69812","#FCBB21"],standard:["#94a2b8","#8398b9","#8292ab"],varied:["#0a2aea","#ea0a8e","#00b827","#890aea"],dual:["#2126C2","#8FAEC2"]}},r=()=>a()?i.dark.blue:i.light.blue,o=e=>{const t=a()?"dark":"light";switch(e){case"varied":return i[t].varied;case"posNeg":return i[t].dual;case"rightEyeSeries":return i[t].greenSeries;case"leftEyeSeries":return i[t].redSeries;case"BEOSeries":return i[t].yellowSeries;default:return i[t].standard}},l=e=>{const t=a()?"dark":"light";switch(e){case"highlight":return i[t].highlight;case"rightEye":return i[t].green;case"leftEye":return i[t].red;case"BEO":return i[t].yellow;default:return"pink"}},n=function(e){let t={linecolor:a()?"#666":"#999",linewidth:1,showgrid:!0,gridcolor:a()?"#292929":"#e6e6e6",tickmode:"auto",nticks:10,ticks:"outside",ticklen:3,tickcolor:a()?"#666":"#ccc",automargin:!0,mirror:!0,connectgaps:!1};const s="y"===e.type;if(e.hasOwnProperty("noMirrorLines")&&(t.mirror=!1),e.hasOwnProperty("domain")&&s&&(t.domain=e.domain),e.hasOwnProperty("title")&&(t.title={text:e.title,standoff:s?10:20,font:{size:12}}),e.hasOwnProperty("rightSide")&&s&&(t.overlaying=e.rightSide,t.side="right",t.showgrid=!1,t.zeroline=!1,t.title.standoff=15),e.customTicks&&(t.tickmode="array",t.tickvals=e.customTicks.vals,t.ticktext=e.customTicks.text,e.customTicks.reverseRange&&(t.autorange="reversed")),e.hasOwnProperty("maxAxisTicks")&&(t.nticks=e.maxAxisTicks),e.hasOwnProperty("useDates")&&(t.tickformat="%b %Y"),e.hasOwnProperty("fixRange")&&(t.fixedrange=!0),e.hasOwnProperty("range")&&(t.range=e.range),e.hasOwnProperty("axisType")&&(t.type=e.axisType),e.hasOwnProperty("useCategories")){let s=e.useCategories.categoryarray;if(t.type="category",t.categoryarray=s,e.useCategories.rangeFit)switch(e.useCategories.rangeFit){case"exact":t.range=[0,s.length-1];break;case"pad":t.range=[-1,s.length];break;case"padTop":t.range=[0,s.length];break;case"padBottom":t.range=[-1,s.length-1]}}if(e.hasOwnProperty("spikes")){const e=a();t.showspikes=!0,t.spikecolor=e?"#0ff":"#00f",t.spikethickness=e?.5:1,t.spikedash=e?"1px,3px":"2px,3px"}return t},d=function(e){const t=a(),s={isDark:t,autosize:!0,margin:{l:50,r:50,t:30,b:40,pad:4,autoexpand:!0},paper_bgcolor:t?"rgba(100,100,100,0.1)":"rgba(255,255,255,0.4)",plot_bgcolor:t?"#111":"#fff",font:{family:"Roboto, 'Open Sans', verdana, arial, sans-serif",size:11,color:t?"#aaa":"#333"},hoverlabel:{bgcolor:t?"#003":"#fff",bordercolor:t?"#009":"#00f",font:{size:11,color:r()}},shapes:[],annotations:[]};if(e.hasOwnProperty("hovermode")?s.hovermode=e.hovermode:s.hovermode="closest",e.hasOwnProperty("colors")?s.colorway=o(e.colors):s.colorway=o("default"),e.hasOwnProperty("plotTitle")&&(s.title={text:e.plotTitle,xref:"paper",yref:"container",x:0,y:1,yanchor:"top",pad:{t:20},font:{size:15}},s.margin.t=50),e.hasOwnProperty("legend")){s.showlegend=!0;const t={font:{size:9},itemclick:"toggleothers",orientation:"h",xanchor:"right",yanchor:"bottom",x:1,y:1};"boolean"==typeof e.legend?s.legend=t:s.legend=Object.assign(t,e.legend)}else s.showlegend=!1;if(e.hasOwnProperty("subplot")&&(s.grid={rows:e.subplot,columns:1,pattern:"independent"}),e.hasOwnProperty("xaxis")&&(s.xaxis=e.xaxis,s.xaxis.title&&(s.margin.b=80)),e.hasOwnProperty("yaxes")&&e.yaxes.forEach(((e,t)=>{t?s["yaxis"+(t+1)]=e:s.yaxis=e,e.title&&("right"==e.side?s.margin.r=80:s.margin.l=80)})),e.hasOwnProperty("rangeSlider")){const a={thickness:.08};t&&(a.bgcolor=s.paper_bgcolor,a.borderwidth=1,a.bordercolor=s.plot_bgcolor),"boolean"!=typeof e.rangeSlider&&(a.range=e.rangeSlider),s.xaxis.rangeslider=a,s.margin.b=15}return e.hasOwnProperty("dateRangeButtons")&&(s.xaxis.rangeselector=Object.assign({x:1,xanchor:"right",buttons:[{label:"Show all",step:"all"},{label:"2 Yr",step:"year",count:2},{label:"1 Yr",step:"year",count:1},{label:"6 Mth",step:"month",count:6}]},(e=>({font:{color:e?"#ccc":"#666"},bgcolor:e?"rgb(30,46,66)":"rgb(255,255,255)",activecolor:e?"rgb(7,69,152)":"rgb(225,225,225)",bordercolor:e?"rgb(10,26,36)":"rgb(255,255,255)",borderwidth:2}))(t))),e.hasOwnProperty("barmode")&&(s.barmode=e.barmode),s},y=(e,t,s,a)=>{e.shapes=e.shapes.concat(t.map(s)),e.annotations=e.annotations.concat(t.map(a))},h={showarrow:!1,align:"left",font:{color:r()},borderpad:2},u=(e,t,s)=>{y(e,t,(({x:e})=>({type:"line",layer:"above",yref:"paper",x0:e,y0:0,x1:e,y1:s,line:{color:r(),width:.5}})),(({name:e,x:t})=>({...h,text:e,textangle:90,x:t,xshift:8,yref:"paper",y:s})))},c={div:null,data:[],layout:{},lines:{v:{verticals:[],h:0},horizontals:[]},storeKeys:{layout:"layout",plot:"plot"},stored:new Map,setSelectableUnits(){s("needs overwriting in specific layout")},buildLayout(){s("define in specific layout")},buildData(){s("define in specific layout")},addVerticalLines(e,t){return Array.isArray(e)||s("core"),this.lines.v.verticals=e,this.lines.v.h=t,this},addHorizontalLines(e){return Array.isArray(e)||s("core"),this.lines.horizontals=e,this},plotlyReact(){this.drawLines(this.layout),Plotly.react(this.div,this.data,this.layout,{displayModeBar:!1,responsive:!0})},drawLines(e){this.lines.v.verticals.length&&u(e,this.lines.v.verticals,this.lines.v.h),this.lines.horizontals.length&&((e,t)=>{y(e,t,(({y:e,yaxis:t})=>({type:"line",layer:"below",xref:"paper",yref:t,x0:0,y0:e,x1:1,y1:e,line:{color:r(),width:2,dash:"3px,12px"}})),(({name:e,y:t,yaxis:s})=>({...h,text:e,xref:"paper",x:0,yshift:8,yref:s,y:t})))})(e,this.lines.horizontals)},prebuild(){},setPlotlyDiv(e){if(!1===e)return t("assuming split view DOM is available..."),!1;this.div=document.getElementById(e),null===this.div&&s(`div is null: ${e}`)},storeLayoutDataForRebuild(e){this.stored.has(this.storeKeys.layout)||this.stored.set(this.storeKeys.layout,e)},storePlotDataForThemeRebuild(e){this.stored.has(this.storeKeys.plot)||this.stored.set(this.storeKeys.plot,e)},rebuild(){this.stored.has(this.storeKeys.plot)&&this.buildData(this.stored.get(this.storeKeys.plot)),this.stored.has(this.storeKeys.layout)&&this.buildLayout(this.stored.get(this.storeKeys.layout)),this.plotlyReact()},plotlyThemeChange(){this.rebuild()}},p={buildLayout(e){this.storeLayoutDataForRebuild(e);const t=n({type:"x",numTicks:20,title:e.xaxis.title}),s=n({type:"y",numTicks:20,title:e.yaxis.y1.title});return this.layout=d({plotTitle:e.plotHeader,xaxis:t,yaxes:[s],barmode:"stack"}),this},buildData(e){return this.data=e,this}},g={...c,...p},m={buildLayout(e){return g.buildLayout(e),this},buildData(e){const t={y:e.y,name:e.name,type:"bar"};return e.hasOwnProperty("x")&&(t.x=e.x),e.hasOwnProperty("hovertemplate")&&(t.hovertemplate=e.hovertemplate),this.data=[t],this}},b={...c,...m},x=({error_y:e})=>({type:"data",array:e,visible:!0,thickness:.5}),v=(e,{x:t,y:s},a)=>({yaxis:e,x:t,y:s,name:a,type:"scatter"}),f=(e=!1,t=!1)=>{let s=t?{dash:"2px,2px",width:2}:{};return e&&(s.color=e),s},k={buildLayout(e){this.storeLayoutDataForRebuild(e);const t=n({type:"x",numTicks:10,spikes:!0,noMirrorLines:!0}),s=n({type:"y",title:e.yaxis.y1.title,range:e.yaxis.y1.range,spikes:!0}),a=n({type:"y",title:e.yaxis.y2.title,range:e.yaxis.y2.range,rightSide:"y1",spikes:!0});return this.layout=d({legend:!0,xaxis:t,yaxes:[s,a],rangeSlider:!0}),this},buildData(e){this.storePlotDataForThemeRebuild(e);let t=[];const s={rightEye:"R",leftEye:"L",BEO:"BEO"},a=(e,t,s,a,i)=>({...v(t,e,`${a}: ${s} `),hovertemplate:`Mean Â± SD<br>${s}: %{y}<br>(N: %{x})`,line:f(i,!0),error_y:x(e)});for(const i of Object.keys(s))if(e.hasOwnProperty(i)){const r=o(`${i}Series`),l=s[i];t=t.concat([a(e[i].CRT,"y1","CRT",l,r[1]),a(e[i].VA,"y2","VA",l,r[0])])}return this.data=t,this}},w={...c,...k},L=e=>"number"==typeof e[0]?(e=>({range:e,axisType:"linear"}))(e):(e=>({useCategories:{showAll:!0,categoryarray:e}}))(e),S=(e,t=!1)=>{const s=document.createElement("div");return s.className=e,t&&(s.innerHTML=t),s},T=(e,t=!1,s=!1)=>{const a=document.createElement(e);return t&&(a.className=t),s&&(a.innerHTML=s),a},O={layout:null,div:null,userSelected:{hoverMode:"closest",vaUnits:""},selectableUnits:!1,linkToLayout(e){return this.layout=e,this.buildDOM(),this},buildDOM(){const e=document.querySelector(".oeplot");null===e&&s("toolBar is only for Summary pages, it requires the div.oeplot structure"),this.div=S("oeplot-toolbar"),e.append(this.div),e.classList.add("with-toolbar")},userChangesSomething(e,t){switch(e){case"plotPointsHoverMode":this.userSelected.hoverMode=t;break;case"vaUnits":this.userSelected.vaUnits=t;break;default:return}this.layout.rebuild()},allowUserToChangeHoverMode(){this.buildDropDown("plotPointsHoverMode","Show labels as:",[{text:"Single",value:this.hoverMode},{text:"Closest",value:"x"},{text:"Grouped",value:"x unified"}])},getHoverMode(){return this.userSelected.hoverMode},allowUserToSelectUnits:function(e){this.userSelected.vaUnits=Object.keys(e).at(0),this.selectableUnits=e;const t=Object.entries(e).map((([e,t])=>({value:e,text:t.name})));this.buildDropDown("vaUnits","Select VA Units",t)},getSelectedUnit(){return this.userSelected.vaUnits},getSelectedUnitNameRange(){return this.selectableUnits[this.getSelectedUnit()]},buildDropDown(e,t,s){const a=T("select");for(const e of s){const t=document.createElement("option");t.value=e.value,t.text=e.text,a.add(t)}const i=S("plot-tool");i.append(T("label",!1,t),a),this.div.append(i),a.addEventListener("change",(({target:t})=>{this.userChangesSomething(e,t.options[t.selectedIndex].value)}))}},P={prebuild(){this.toolBar=O.linkToLayout(this),this.toolBar.allowUserToChangeHoverMode()},setSelectableUnits(e){return this.toolBar.allowUserToSelectUnits(e),this},buildLayout(e){this.storeLayoutDataForRebuild(e);const t=[[0,1]],s=n({type:"x",numTicks:10,useDates:!0,spikes:!0,noMirrorLines:!0}),a=n({type:"y",domain:t[1],title:e.yaxis.y1.title,range:e.yaxis.y1.range,spikes:!0}),{name:i,customTicks:r}=this.toolBar.getSelectedUnitNameRange(),o=n({type:"y",title:`VA - ${i}`,domain:t[0],rightSide:"y1",spikes:!0,customTicks:r});return this.layout=d({legend:!0,xaxis:s,yaxes:[a,o],rangeSlider:!0,hovermode:this.toolBar.getHoverMode()}),this},buildData(e){this.storePlotDataForThemeRebuild(e);let t=[];const s={rightEye:"R",leftEye:"L",BEO:"BEO"},a=(e,t,s,a,i,r=!1)=>({...v(t,e,`${a}: ${s} `),mode:"lines+markers",hovertemplate:`${s}: %{y}<br>%{x}`,line:f(i,r)});for(const i of Object.keys(s))if(e.hasOwnProperty(i)){const r=o(`${i}Series`),l=s[i],n=e[i].VA.units[this.toolBar.getSelectedUnit()];t=t.concat([a(e[i].CRT,"y1","CRT",l,r[0],!0),a(n,"y2","VA",l,r[1])])}return this.data=t,this}},B={...c,...P},D={buildLayout(e){this.storeLayoutDataForRebuild(e);const t=n({type:"x",title:e.xaxis.title,numTicks:20,range:e.xaxis.range}),s=n({type:"y",title:e.yaxis.y1.title,range:e.yaxis.y1.range,numTicks:20}),a=n({type:"y",title:e.yaxis.y2.title,rightSide:"y1",numTicks:20});return this.layout=d({colors:"varied",legend:!0,xaxis:t,yaxes:[s,a],rangeSlider:!0}),this},buildData(e){const t=(e,t,s)=>({...v(t,e,s),hovertemplate:`Mean Â± SD<br>${s}: %{y}<br>(N: %{x})`,error_y:x(e)});return this.data=[t(e.VA,"y1","VA"),t(e.IOP,"y2","IOP")],this}},E={...c,...D},R=e=>{let t,a;switch(e){case"management":t="square",a=9;break;case"image":t="triangle-down",a=11;break;case"drug":t="diamond",a=9;break;case"injection":t="star-diamond",a=10;break;default:s("markerFor")}return{symbol:t,size:a}},C=(e,t=!1)=>{const a={marker:R(e)};switch(e){case"management":case"image":case"injection":a.mode="markers";break;case"drug":a.mode="lines+markers",a.line={width:3};break;default:s(`eventStyle - unknown type: ${e}`)}return t&&(a.marker&&(a.marker.color=t),a.line&&(a.line.color=t)),a},M={once:!1,layoutBtn:null,layoutBtnIcon:null,layoutOpts:null,oesSide:{},init(e){if(this.once)return;this.once=!0;const t=document.querySelector(".layout-select-btn");if(null===t||t.classList.contains("not-allowed"))return;const s=t.parentElement,a=this.buildLayoutOpts(s);s.addEventListener("mouseleave",(()=>this.hide())),t.addEventListener("mouseenter",(()=>this.show())),a.addEventListener("pointerdown",(({target:t})=>{this.onChangeLayout(t.dataset.layout),e.relayoutPlots(),setTimeout((()=>{e.relayoutPlots()}),50)})),this.layoutBtn=t,this.layoutBtnIcon=t.querySelector(".oes-layout-icon"),this.layoutOpts=a,this.oesSide.right=document.querySelector(".oes-right-side"),this.oesSide.left=document.querySelector(".oes-left-side")},show(){this.layoutOpts.classList.remove("hidden"),this.layoutBtn.classList.add("active")},hide(){this.layoutOpts.classList.add("hidden"),this.layoutBtn.classList.remove("active")},buildLayoutOpts(e){const t=S("layout-options"),s=["1-0","2-1","1-1","1-2","0-1"].map((e=>`<div class="layout-option-btn" data-layout="${e}"><i class="oes-layout-icon i-${e}"></i></div>`));return t.innerHTML=s.join(""),t.classList.add("hidden"),e.append(t),t},onChangeLayout(e){const t=this.oesSide.left,a=this.oesSide.right;switch(null!==t&&null!==a||console.error("nxPlot: DOM sides null?"),t.classList.remove("fill-2","fill-3"),a.classList.remove("fill-2","fill-3"),e){case"1-0":a.classList.add("fill-3");break;case"2-1":a.classList.add("fill-2");break;case"0-1":t.classList.add("fill-3");break;case"1-2":t.classList.add("fill-2");break;case"1-1":break;default:return s("oesChangeSidesLayout"),!1}this.layoutBtnIcon.className=`oes-layout-icon i-${e}`}},U={plots:new Map,toolBar:null,baseLayout:null,buildData(){s("Split plots use buildRightData() and/or buildLeftData() instead")},buildDataTraces:()=>(s("Override in specific split layout!"),{}),buildRightData(e){return this.buildSplitData("R",e),this},buildLeftData(e){return this.buildSplitData("L",e),this},buildSplitData(e,t){const a="R"===e?"right":"left",i=document.querySelector(`.oes-${a}-side`);null===i?s(`Requires fixed DOM structure, can not find: div.'.oes-${a}-side'`):M.init(this);const r=new Map;r.set("storedPlotData",t),r.set("div",i),r.set("data",this.buildDataTraces(t));const o=d({colors:`${a}EyeSeries`,plotTitle:`${e+a.substring(1)} eye`,...this.baseLayout});t.hasOwnProperty("procedures")&&u(o,Object.values(t.procedures),this.procedureVericalHeight),r.set("layout",o),this.plots.set(`${e}`,r)},setBaseLayoutForPlots(e){const t={legend:{yanchor:"bottom"},xaxis:n({type:"x",numTicks:10,useDates:!0,spikes:!0,noMirrorLines:!0}),rangeSlider:!0,dateRangeButtons:!0};this.baseLayout={...t,...e}},buildEvents:(e,t)=>Object.values(e).map((e=>({oeEventType:e.event,...v(t,e,e.name),...C(e.event),customdata:e.customdata,hovertemplate:e.customdata?"%{y}<br>%{customdata}<br>%{x}<extra></extra>":"%{y}<br>%{x}<extra></extra>",showlegend:!1}))),plotlyReact(){["R","L"].forEach((e=>{if(this.plots.has(e)){const t=this.plots.get(e);this.drawLines(t.get("layout")),Plotly.react(t.get("div"),t.get("data"),t.get("layout"),{displayModeBar:!1,responsive:!0})}}))},rebuild(){this.buildLayout(this.stored.get("layout")),["R","L"].forEach((e=>{if(this.plots.has(e)){const t=this.plots.get(e);this.buildSplitData(e,t.get("storedPlotData"))}})),this.plotlyReact()},plotlyThemeChange(){this.rebuild()},relayoutPlots(){["R","L"].forEach((e=>{if(this.plots.has(e)){const t=this.plots.get(e);Plotly.relayout(t.get("div"),t.get("layout"))}}))}},A={...c,...U},F={prebuild(){this.toolBar=O.linkToLayout(this),this.toolBar.allowUserToChangeHoverMode()},buildLayout(e){this.storeLayoutDataForRebuild(e);const t=[[.7,1],[0,.64]],s=n({type:"y",domain:t[1],title:e.yaxis.y1.title,range:e.yaxis.y1.range,spikes:!0}),a=n({type:"y",domain:t[0],useCategories:{categoryarray:e.allEvents,rangeFit:"pad"},spikes:!0});return this.setBaseLayoutForPlots({legend:{y:t[1][1]},yaxes:[s,a],subplot:t.length,hovermode:this.toolBar.getHoverMode()}),this},buildDataTraces(e){return[{...v("y",e.daily,e.daily.name),mode:"markers",hovertemplate:`${e.daily.name}: %{y}:00<extra></extra>`},...this.buildEvents(e.events,"y2")]}},$={...A,...F},_={prebuild(){this.toolBar=O.linkToLayout(this),this.toolBar.allowUserToChangeHoverMode(),this.procedureVericalHeight=.64},setSelectableUnits(e){return this.toolBar.allowUserToSelectUnits(e),this},buildLayout(e){this.storeLayoutDataForRebuild(e);const t=[[.7,1],[.15,.64],[0,.15]],s=n({type:"y",domain:t[2],useCategories:{categoryarray:["NPL","PL","HM","CF"],rangeFit:"padTop"},spikes:!0}),a=n({type:"y",domain:t[1],title:e.yaxis.y2.title,range:e.yaxis.y2.range,spikes:!0}),i=n({type:"y",domain:t[0],useCategories:{categoryarray:e.allEvents,rangeFit:"pad"},spikes:!0}),{name:r,range:o}=this.toolBar.getSelectedUnitNameRange(),l=n(Object.assign({type:"y",title:`VA - ${r}`,domain:t[1],rightSide:"y2",spikes:!0},L(o)));return this.setBaseLayoutForPlots({legend:{y:t[1][1]},yaxes:[s,a,l,i],subplot:t.length,hovermode:this.toolBar.getHoverMode()}),this},buildDataTraces(e){const t={...v("y1",e.VA.offScale,`${e.VA.offScale.name}`),mode:"lines+markers",hovertemplate:"%{y}<br>%{x}"},s={...v("y2",e.CRT,`${e.CRT.name}`),mode:"lines+markers",hovertemplate:"CRT: %{y}<br>%{x}",line:{dash:"2px,2px",width:2}},a=e.VA.units[this.toolBar.getSelectedUnit()];return[t,s,{...v("y3",a,`${a.name}`),mode:"lines+markers",hovertemplate:a.name+": %{y}<br>%{x}"},...this.buildEvents(e.events,"y4")]}},V={...A,..._},H={prebuild(){this.toolBar=O.linkToLayout(this),this.toolBar.allowUserToChangeHoverMode(),this.procedureVericalHeight=.77},setSelectableUnits(e){return this.toolBar.allowUserToSelectUnits(e),this},buildLayout(e){this.storeLayoutDataForRebuild(e);const t=[[.82,1],[.47,.77],[.1,.42],[0,.1]],s=n({type:"y",domain:t[3],useCategories:{categoryarray:["NPL","PL","HM","CF"],rangeFit:"padTop"},spikes:!0}),a=n({type:"y",domain:t[2],title:e.yaxis.y2.title,range:e.yaxis.y2.range,spikes:!0,maxAxisTicks:12}),i=n({type:"y",domain:t[1],title:e.yaxis.y4.title,range:e.yaxis.y4.range,maxAxisTicks:12,spikes:!0}),r=n({type:"y",domain:t[0],useCategories:{categoryarray:e.allEvents,rangeFit:"pad"},spikes:!0}),{name:o,range:l}=this.toolBar.getSelectedUnitNameRange(),d=n(Object.assign({type:"y",title:`VA - ${o}`,domain:t[1],rightSide:"y2",spikes:!0},L(l)));return this.setBaseLayoutForPlots({legend:{y:t[1][1]},yaxes:[s,a,d,i,r],subplot:t.length,hovermode:this.toolBar.getHoverMode()}),this},buildDataTraces(e){const t={...v("y1",e.VA.offScale,`${e.VA.offScale.name}`),mode:"lines+markers",hovertemplate:"%{y}<br>%{x}"},s={...v("y2",e.VFI,e.VFI.name),mode:"lines+markers",hovertemplate:"%{y}<br>%{x}<extra></extra>",line:{dash:"2px,2px",width:2}},a={...v("y4",e.IOP,e.IOP.name),mode:"lines+markers",hovertemplate:"IOP: %{y}<br>%{x}<extra></extra>"},i=e.VA.units[this.toolBar.getSelectedUnit()];return[t,s,a,{...v("y3",i,`${i.name}`),mode:"lines+markers",hovertemplate:i.name+": %{y}<br>%{x}"},...this.buildEvents(e.events,"y5")]}},j={...A,...H},z={prebuild(){this.toolBar=O.linkToLayout(this),this.toolBar.allowUserToChangeHoverMode(),this.procedureVericalHeight=.64},buildLayout(e){this.storeLayoutDataForRebuild(e);const t=[[.7,1],[0,.64]],s=n({type:"y",domain:t[1],title:e.yaxis.y1.title,customTicks:e.yaxis.y1.customTicks,spikes:!0}),a=n({type:"y",domain:t[0],useCategories:{categoryarray:e.allEvents,rangeFit:"pad"},spikes:!0});return this.setBaseLayoutForPlots({legend:{y:t[1][1]},yaxes:[s,a],subplot:t.length,hovermode:this.toolBar.getHoverMode()}),this},buildDataTraces(e){const t={...v("y1",e.VA.units.logMAR,e.VA.units.logMAR.name),mode:"lines+markers",hovertemplate:"%{y}<br>%{x}"},s={...v("y1",e.all,e.all.name),mode:"markers",hovertemplate:"%{y}<br>%{x}"};return[t,{...v("y1",e.BEO.VA.units.logMAR,e.BEO.VA.units.logMAR.name),mode:"lines+markers",hovertemplate:"%{y}<br>%{x}",line:f(l("BEO"),!0)},s,...this.buildEvents(e.events,"y2")]}},I={...A,...z};var N=Object.freeze({__proto__:null,barChart:b,customData:g,eyesOutcomes_Errors:w,eyesOutcomes_vaChangeableUnits:B,outcomes_Errors:E,splitRL_Adherence:$,splitRL_Glaucoma_vaChangeableUnits:j,splitRL_MedicalRetina_vaChangeableUnits:V,splitRL_Strabismus:I});window.hasOwnProperty("Plotly")?t(`nxPlot is available, using Plot.ly v${Plotly.version}`):s("Plot.ly JS is required");const q=new Set(["customData","barChart","eyesOutcomes_Errors","eyesOutcomes_vaChangeableUnits","outcomes_Errors","splitRL_Adherence","splitRL_Glaucoma_vaChangeableUnits","splitRL_MedicalRetina_vaChangeableUnits","splitRL_Strabismus"]),K=new Map;for(const e of q)K.set(e,N[e]);Object.defineProperty(window,"nxPlot",{value:(e,s=!1)=>{let a=!1;try{a=K.get(e),t(`Building: ${e}`)}catch({name:t}){return console.error(`Requested plot template: "${e}" is invalid. \n\t\tValid plotTemplates are:\n${Array.from(K.keys()).join("\n")}`),a}return a.setPlotlyDiv(s),a.prebuild(),document.addEventListener("oeThemeChange",(()=>{a.plotlyThemeChange()})),a},writable:!1}),Object.defineProperty(window,"nxPlotColor",{value:{getBlue:r,getColor:l,getColorSeries:o},writable:!1})}();
